class wellKnownPrincipals{
    static [string[]] $wellKnownSIDs=@(
        "S-1-5-1"
        "S-1-5-113"
        "S-1-5-114"
        "S-1-5-2"
        "S-1-5-3"
        "S-1-5-4"
        "S-1-5-6"
        "S-1-5-7"
        "S-1-5-8"
        "S-1-5-9"
        "S-1-5-10"
        "S-1-5-11"
        "S-1-5-12"
        "S-1-5-13"
        "S-1-5-14"
        "S-1-5-15"
        "S-1-5-17"
        "S-1-5-18"
        "S-1-5-19"
        "S-1-5-20"
        "S-1-5-32-544"
        "S-1-5-32-545"
        "S-1-5-32-546"
        "S-1-5-32-547"
        "S-1-5-32-548"
        "S-1-5-32-549"
        "S-1-5-32-550"
        "S-1-5-32-551"
        "S-1-5-32-552"
        "S-1-5-32-554"
        "S-1-5-32-555"
        "S-1-5-32-556"
        "S-1-5-32-557"
        "S-1-5-32-558"
        "S-1-5-32-559"
        "S-1-5-32-560"
        "S-1-5-32-561"
        "S-1-5-32-562"
        "S-1-5-32-568"
        "S-1-5-32-569"
        "S-1-5-32-573"
        "S-1-5-32-574"
        "S-1-5-32-575"
        "S-1-5-32-576"
        "S-1-5-32-577"
        "S-1-5-32-578"
        "S-1-5-32-579"
        "S-1-5-32-580"
        "S-1-5-64-10"
        "S-1-5-64-14"
        "S-1-5-64-21"
        "S-1-5-80"
        "S-1-5-80-0"
        "S-1-5-83-0"
    )
    static [string[]] $wellKnownRIDs=@(
        "500"
        "501"
        "502"
        "512"
        "513"
        "514"
        "515"
        "516"
        "517"
        "518"
        "519"
        "520"
        "544"
        "545"
        "546"
        "547"
        "551"
        "552"
        "553"
    )

    static [boolean] isWellKnown([string]$sid){
        if($sid -in [wellKnownPrincipals]::wellKnownSIDs){return $true} # found in known SID list
        if($sid -notmatch "S-\d{1}-(\d{1,14}-)+(?<RID>\d{1,14})$") {throw "$sid is not a valid SID"} # not a valid SID. Ideally exception should be thrown here
        else{if($Matches.RID -in [wellKnownPrincipals]::wellKnownRIDs) {return $true}}
        return $false
    }
}

# $sid="S-1-5-21-329068152-1214440a339-682003330-553"
# #$sid="S-1-5-32-5783"
# try {[wellKnownPrincipals]::isWellKnown($sid)}
# catch {$_}
# write-host "continue"
